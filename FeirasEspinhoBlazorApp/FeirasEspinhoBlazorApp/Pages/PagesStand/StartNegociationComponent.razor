@page "/startnegociation"
@using SourceCode;
@using SourceCode.Vendas;
@using FeirasEspinhoBlazorApp.Pages.PagesNegociation;

<h3>Negociação</h3>
<br />

<div>
	<div>
		<label><b>Insira o valor que pretende pagar</b></label>
		<input type="text" class="tb" id="precoNegocicao" name="precoNegocicao" placeholder="xxxxxxxx" @bind-value="valorapagar" />
	</div>
	<br />
	<div>
		<button class="buttonA buttonTable1" @onclick="Confirmar">Confirmar</button>
		<button class="buttonA buttonTable2" @onclick="Cancelar">Cancelar</button>
	</div>
</div>

@code
{
	[Parameter, EditorRequired]
	public Venda venda { get; set; }
	[Parameter, EditorRequired]
	public int returnPage { get; set; }
	private string valorapagar = "";
	public void Confirmar()
	{
		if(returnPage == 0)
		{
			SistemaFeiras.GetInstance().AddNegociacaoVenda(venda, new Negociacao(0, venda.Preco, float.Parse(valorapagar), false, false));
			ShowStandComponent showStandComponent = ShowStandComponent.GetInstance();
			showStandComponent.ShowStand("Negociação registada");
		}
		else
		{
			SistemaFeiras.GetInstance().RegistaNovoPreco((int) venda.Negociacao, float.Parse(valorapagar));
			ShowNegociacoesComponent.GetInstance().GetBack("Preço Registado");
		}

	}
	public void Cancelar()
	{
		if (returnPage == 0)
			ShowStandComponent.GetInstance().ShowStand(3);
		else
			ShowNegociacoesComponent.GetInstance().GetBack(0);
	}
}
